<html lang="en">
<style>
  font-family:helvetica
</style>
<script src="https://d3js.org/d3.v6.js"></script>
<script src="https://rawgit.com/susielu/d3-annotation/master/d3-annotation.min.js"></script>


<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>A History of Earthquakes in Taiwan</title>
</head>
<body>
  <h1>A History of Earthquakes in Taiwan</h1>
  <p>Because of Taiwan's location along the Pacific "Ring of Fire", the country is particular prone to very frequent earthquakes. Coupled with Taiwan's abundance of mountains and tall structures, these earthquakes can be quite dangerous for citizens. The Taiwan of today is prepared to handle earthquakes thanks to improved disaster response and reduction, a quality that was developed as a necessary response. This page aims to visualize Taiwan's history of earthquakes and their impacts from 1973 to 2024.</p>
</body>

<div id="magnitude_chart"></div>

<div>
    <a href="index.html" class="magnitude_button">Magnitude</a>
    <a href="depth.html" class="depth_button">Depth</a>
    <a href="phases.html" class="phases_button">Number of Phases Arriving</a>
</div>

<p>Data from: <a href="https://www.kaggle.com/datasets/taweilo/taiwan-earthquake-dataset/data">Taiwan Earthquake Dataset</a></p>

</body>
<script>
const margin = {top: 20, right: 30, bottom: 60, left: 80};
const width = 960 - margin.left - margin.right;
const height = 500 - margin.top - margin.bottom;

const svg = d3.select("#magnitude_chart")
    .append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
    .append("g")
    .attr("transform", `translate(${margin.left},${margin.top})`);

var parseDate = d3.timeParse("%Y-%m-%d");

var dates = [];
for (let obj of data) {
  dates.push(parseTime(obj.date));
}
	
d3.csv("https://raw.githubusercontent.com/EMui81/narrative-visualization/main/earthquake-detail.csv").then(data => {
    data.forEach(d => {
	d.date = parseDate(d.date);
        d.depth = +d.depth;
    });

    const xScale = d3.scaleBand()
      .domain([1973, 1974, 1975, 1976, 1977, 1978, 1979, 1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023, 2024])
      .range([0, width]);

    const x = d3.scaleTime()
      .domain(d3.extent(data, d => d.date))
      .range([0, width])
      .nice();

    const yScale = d3.scaleLinear()
      .domain([0, d3.max(data, d => d.depth)]).range([height, 0]);

    svg.append("g")
        .attr("transform", `translate(0,${height})`)
        .call(d3.axisBottom(x).ticks(d3.timeYear.every(1))
        .tickFormat(d3.timeFormat("%Y")))
	.selectAll("text")  
    	.style("text-anchor", "end")
    	.attr("dx", "-.8em")
    	.attr("dy", ".15em")
   	.attr("transform", "rotate(-65)")
	.nice();

    svg.append("g")
        .call(d3.axisLeft(yScale));

    svg.selectAll("dot")
      .data(data)
      .enter()
      .append("circle")
        .attr("cx", d => x(parseDate(d.date)))
        .attr("cy", d => yScale(d.depth))
        .attr("r", 5)
        .style("fill", "#69b3a2")
	.style("opacity", 0.5);
}).catch(error => {
    console.error("Error:", error);
});
</script>
</html>
